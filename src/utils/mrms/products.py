"""
MRMS Product Enumeration
========================
This module provides a single :class:`MRMSProduct` enum that enumerates every
operational product folder published in the MRMS S3 bucket (CONUS domain).

Each *member name* is a legal, screaming‑snake Python identifier derived from
its raw folder name (non‑alphanumeric characters are replaced with "_" and a
leading underscore is added when the identifier would otherwise begin with a
digit).  The *member value* remains exactly the original folder string so it
can be used directly when constructing object keys, URLs, or file paths.

Example
-------
>>> from mrms_products import MRMSProduct
>>> MRMSProduct.BREF_1HR_MAX_00_50.value
'BREF_1HR_MAX_00.50'

>>> # Reverse lookup from raw string
>>> lookup = {m.value: m for m in MRMSProduct}
>>> lookup['MergedReflectivityComposite_00.50']
<MRMSProduct.MERGED_REFLECTIVITY_COMPOSITE_00_50: 'MergedReflectivityComposite_00.50'>
"""

from __future__ import annotations

import re
from enum import Enum
from typing import List


RAW_PRODUCTS: List[str] = [
    "BREF_1HR_MAX_00.50",
    "BrightBandBottomHeight_00.00",
    "BrightBandTopHeight_00.00",
    "CREF_1HR_MAX_00.50",
    "EchoTop_18_00.50",
    "EchoTop_30_00.50",
    "EchoTop_50_00.50",
    "EchoTop_60_00.50",
    "FLASH_CREST_MAXSOILSAT_00.00",
    "FLASH_CREST_MAXSTREAMFLOW_00.00",
    "FLASH_CREST_MAXUNITSTREAMFLOW_00.00",
    "FLASH_HP_MAXSTREAMFLOW_00.00",
    "FLASH_HP_MAXUNITSTREAMFLOW_00.00",
    "FLASH_QPE_ARI01H_00.00",
    "FLASH_QPE_ARI03H_00.00",
    "FLASH_QPE_ARI06H_00.00",
    "FLASH_QPE_ARI12H_00.00",
    "FLASH_QPE_ARI24H_00.00",
    "FLASH_QPE_ARI30M_00.00",
    "FLASH_QPE_ARIMAX_00.00",
    "FLASH_QPE_FFG01H_00.00",
    "FLASH_QPE_FFG03H_00.00",
    "FLASH_QPE_FFG06H_00.00",
    "FLASH_QPE_FFGMAX_00.00",
    "FLASH_SAC_MAXSOILSAT_00.00",
    "FLASH_SAC_MAXSTREAMFLOW_00.00",
    "FLASH_SAC_MAXUNITSTREAMFLOW_00.00",
    "GaugeInflIndex_01H_Pass1_00.00",
    "GaugeInflIndex_01H_Pass2_00.00",
    "GaugeInflIndex_03H_Pass1_00.00",
    "GaugeInflIndex_03H_Pass2_00.00",
    "GaugeInflIndex_06H_Pass1_00.00",
    "GaugeInflIndex_06H_Pass2_00.00",
    "GaugeInflIndex_12H_Pass1_00.00",
    "GaugeInflIndex_12H_Pass2_00.00",
    "GaugeInflIndex_24H_Pass1_00.00",
    "GaugeInflIndex_24H_Pass2_00.00",
    "GaugeInflIndex_48H_Pass1_00.00",
    "GaugeInflIndex_48H_Pass2_00.00",
    "GaugeInflIndex_72H_Pass1_00.00",
    "GaugeInflIndex_72H_Pass2_00.00",
    "H50_Above_-20C_00.50",
    "H50_Above_0C_00.50",
    "H60_Above_-20C_00.50",
    "H60_Above_0C_00.50",
    "HeightCompositeReflectivity_00.50",
    "HeightLowLevelCompositeReflectivity_00.50",
    "LayerCompositeReflectivity_ANC_00.50",
    "LayerCompositeReflectivity_High_00.50",
    "LayerCompositeReflectivity_Low_00.50",
    "LayerCompositeReflectivity_Super_00.50",
    "LightningProbabilityNext30minGrid_scale_1",
    "LightningProbabilityNext60minGrid_scale_1",
    "LowLevelCompositeReflectivity_00.50",
    "LtgJumpGrid_Max_005min_scale_1",
    "LtgJumpGrid_scale_1",
    "LVL3_HighResVIL_00.50",
    "LVL3_HREET_00.50",
    "MergedAzShear_0-2kmAGL_00.50",
    "MergedAzShear_3-6kmAGL_00.50",
    "MergedBaseReflectivity_00.50",
    "MergedBaseReflectivityQC_00.50",
    "MergedReflectivityAtLowestAltitude_00.50",
    "MergedReflectivityComposite_00.50",
    "MergedReflectivityQC_00.50",
    "MergedReflectivityQC_00.75",
    "MergedReflectivityQC_01.00",
    "MergedReflectivityQC_01.25",
    "MergedReflectivityQC_01.50",
    "MergedReflectivityQC_01.75",
    "MergedReflectivityQC_02.00",
    "MergedReflectivityQC_02.25",
    "MergedReflectivityQC_02.50",
    "MergedReflectivityQC_02.75",
    "MergedReflectivityQC_03.00",
    "MergedReflectivityQC_03.50",
    "MergedReflectivityQC_04.00",
    "MergedReflectivityQC_04.50",
    "MergedReflectivityQC_05.00",
    "MergedReflectivityQC_05.50",
    "MergedReflectivityQC_06.00",
    "MergedReflectivityQC_06.50",
    "MergedReflectivityQC_07.00",
    "MergedReflectivityQC_07.50",
    "MergedReflectivityQC_08.00",
    "MergedReflectivityQC_08.50",
    "MergedReflectivityQC_09.00",
    "MergedReflectivityQC_10.00",
    "MergedReflectivityQC_11.00",
    "MergedReflectivityQC_12.00",
    "MergedReflectivityQC_13.00",
    "MergedReflectivityQC_14.00",
    "MergedReflectivityQC_15.00",
    "MergedReflectivityQC_16.00",
    "MergedReflectivityQC_17.00",
    "MergedReflectivityQC_18.00",
    "MergedReflectivityQC_19.00",
    "MergedReflectivityQCComposite_00.50",
    "MergedReflectivityQComposite_00.50",
    "MergedRhoHV_00.50",
    "MergedRhoHV_00.75",
    "MergedRhoHV_01.00",
    "MergedRhoHV_01.25",
    "MergedRhoHV_01.50",
    "MergedRhoHV_01.75",
    "MergedRhoHV_02.00",
    "MergedRhoHV_02.25",
    "MergedRhoHV_02.50",
    "MergedRhoHV_02.75",
    "MergedRhoHV_03.00",
    "MergedRhoHV_03.50",
    "MergedRhoHV_04.00",
    "MergedRhoHV_04.50",
    "MergedRhoHV_05.00",
    "MergedRhoHV_05.50",
    "MergedRhoHV_06.00",
    "MergedRhoHV_06.50",
    "MergedRhoHV_07.00",
    "MergedRhoHV_07.50",
    "MergedRhoHV_08.00",
    "MergedRhoHV_08.50",
    "MergedRhoHV_09.00",
    "MergedRhoHV_10.00",
    "MergedRhoHV_11.00",
    "MergedRhoHV_12.00",
    "MergedRhoHV_13.00",
    "MergedRhoHV_14.00",
    "MergedRhoHV_15.00",
    "MergedRhoHV_16.00",
    "MergedRhoHV_17.00",
    "MergedRhoHV_18.00",
    "MergedRhoHV_19.00",
    "MergedZdr_00.50",
    "MergedZdr_00.75",
    "MergedZdr_01.00",
    "MergedZdr_01.25",
    "MergedZdr_01.50",
    "MergedZdr_01.75",
    "MergedZdr_02.00",
    "MergedZdr_02.25",
    "MergedZdr_02.50",
    "MergedZdr_02.75",
    "MergedZdr_03.00",
    "MergedZdr_03.50",
    "MergedZdr_04.00",
    "MergedZdr_04.50",
    "MergedZdr_05.00",
    "MergedZdr_05.50",
    "MergedZdr_06.00",
    "MergedZdr_06.50",
    "MergedZdr_07.00",
    "MergedZdr_07.50",
    "MergedZdr_08.00",
    "MergedZdr_08.50",
    "MergedZdr_09.00",
    "MergedZdr_10.00",
    "MergedZdr_11.00",
    "MergedZdr_12.00",
    "MergedZdr_13.00",
    "MergedZdr_14.00",
    "MergedZdr_15.00",
    "MergedZdr_16.00",
    "MergedZdr_17.00",
    "MergedZdr_18.00",
    "MergedZdr_19.00",
    "MESH_00.50",
    "MESH_Max_120min_00.50",
    "MESH_Max_1440min_00.50",
    "MESH_Max_240min_00.50",
    "MESH_Max_30min_00.50",
    "MESH_Max_360min_00.50",
    "MESH_Max_60min_00.50",
    "Model_0degC_Height_00.50",
    "Model_SurfaceTemp_00.50",
    "Model_WetBulbTemp_00.50",
    "MultiSensor_QPE_01H_Pass1_00.00",
    "MultiSensor_QPE_01H_Pass2_00.00",
    "MultiSensor_QPE_03H_Pass1_00.00",
    "MultiSensor_QPE_03H_Pass2_00.00",
    "MultiSensor_QPE_06H_Pass1_00.00",
    "MultiSensor_QPE_06H_Pass2_00.00",
    "MultiSensor_QPE_12H_Pass1_00.00",
    "MultiSensor_QPE_12H_Pass2_00.00",
    "MultiSensor_QPE_24H_Pass1_00.00",
    "MultiSensor_QPE_24H_Pass2_00.00",
    "MultiSensor_QPE_48H_Pass1_00.00",
    "MultiSensor_QPE_48H_Pass2_00.00",
    "MultiSensor_QPE_72H_Pass1_00.00",
    "MultiSensor_QPE_72H_Pass2_00.00",
    "NLDN_CG_001min_AvgDensity_00.00",
    "NLDN_CG_005min_AvgDensity_00.00",
    "NLDN_CG_015min_AvgDensity_00.00",
    "NLDN_CG_030min_AvgDensity_00.00",
    "POSH_00.50",
    "PrecipFlag_00.00",
    "PrecipRate_00.00",
    "RadarAccumulationQualityIndex_01H_00.00",
    "RadarAccumulationQualityIndex_03H_00.00",
    "RadarAccumulationQualityIndex_06H_00.00",
    "RadarAccumulationQualityIndex_12H_00.00",
    "RadarAccumulationQualityIndex_24H_00.00",
    "RadarAccumulationQualityIndex_48H_00.00",
    "RadarAccumulationQualityIndex_72H_00.00",
    "RadarOnly_QPE_01H_00.00",
    "RadarOnly_QPE_03H_00.00",
    "RadarOnly_QPE_06H_00.00",
    "RadarOnly_QPE_12H_00.00",
    "RadarOnly_QPE_15M_00.00",
    "RadarOnly_QPE_24H_00.00",
    "RadarOnly_QPE_48H_00.00",
    "RadarOnly_QPE_72H_00.00",
    "RadarOnly_QPE_Since12Z_00.00",
    "RadarQualityIndex_00.00",
    "Reflectivity_-10C_00.50",
    "Reflectivity_-15C_00.50",
    "Reflectivity_-20C_00.50",
    "Reflectivity_-5C_00.50",
    "Reflectivity_0C_00.50",
    "ReflectivityAtLowestAltitude_00.50",
    "RotationTrack120min_00.50",
    "RotationTrack1440min_00.50",
    "RotationTrack240min_00.50",
    "RotationTrack30min_00.50",
    "RotationTrack360min_00.50",
    "RotationTrack60min_00.50",
    "RotationTrackML120min_00.50",
    "RotationTrackML1440min_00.50",
    "RotationTrackML240min_00.50",
    "RotationTrackML30min_00.50",
    "RotationTrackML360min_00.50",
    "RotationTrackML60min_00.50",
    "SeamlessHSR_00.00",
    "SeamlessHSRHeight_00.00",
    "SHI_00.50",
    "SyntheticPrecipRateID_00.00",
    "VII_00.50",
    "VIL_00.50",
    "VIL_Density_00.50",
    "VIL_Max_120min_00.50",
    "VIL_Max_1440min_00.50",
    "VIL_Max_240min_00.50",
    "VIL_Max_30min_00.50",
    "VIL_Max_360min_00.50",
    "VIL_Max_60min_00.50",
    "WarmRainProbability_00.50",
]


def _to_identifier(name: str) -> str:
    """Return a legal, screaming‑snake identifier for *name*."""
    ident = re.sub(r"[^0-9A-Za-z]+", "_", name).upper()
    if ident[0].isdigit():
        ident = "_" + ident
    return ident


MRMSProduct = Enum(
    "MRMSProduct",
    {_to_identifier(p): p for p in RAW_PRODUCTS},  # type: ignore[arg-type]
    module=__name__,
)

del re, List, _to_identifier  # keep public namespace tidy

__all__ = ["MRMSProduct", "RAW_PRODUCTS"]
